# Migration `20201118010221-partner`

This migration has been generated by Wadhah mahrouk at 11/18/2020, 2:02:21 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "Partner" (
"id" SERIAL,
    "name" TEXT NOT NULL,
    "code" TEXT,
    "email" TEXT,
    "rate" INTEGER,

    PRIMARY KEY ("id")
)

CREATE TABLE "QrScan" (
"id" SERIAL,
    "date" TIMESTAMP(3) NOT NULL,
    "memberId" INTEGER NOT NULL,
    "partnerId" INTEGER NOT NULL,

    PRIMARY KEY ("id")
)

ALTER TABLE "QrScan" ADD FOREIGN KEY("memberId")REFERENCES "Member"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "QrScan" ADD FOREIGN KEY("partnerId")REFERENCES "Partner"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201118001626-i..20201118010221-partner
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -14,21 +14,40 @@
   members Member[]
 }
 model Member {
-  id          Int         @id @default(autoincrement())
+  id          Int          @id @default(autoincrement())
   name        String
   lastname    String
   fbLink      String
   phone       Int
-  email       String      @unique
+  email       String       @unique
   chapters    Chapter[]
   ieeeAccount IEEEAccount?
+  qrScans     QrScan[]
 }
 model IEEEAccount {
-  id               Int       @id 
+  id               Int       @id
   email            String
   registrationDate DateTime?
   member           Member    @relation(fields: [memberId], references: [id])
   memberId         Int
 }
+
+model Partner {
+  id      Int      @id @default(autoincrement())
+  name    String
+  code    String?
+  email   String?
+  rate    Int?
+  qrScans QrScan[]
+}
+
+model QrScan {
+  id        Int      @id @default(autoincrement())
+  member    Member   @relation(fields: [memberId], references: [id])
+  partner   Partner  @relation(fields: [partnerId], references: [id])
+  date      DateTime
+  memberId  Int
+  partnerId Int
+}
```


